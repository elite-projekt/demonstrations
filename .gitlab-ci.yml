stages:
  - build

push-phishing-image:
  stage: build
  image:
    name: gcr.io/kaniko-project/executor:debug
    entrypoint: [""]
  script:
    - sh ./ci/push-phishing-image.sh

push-navigation-image:
  stage: build
  image:
    name: gcr.io/kaniko-project/executor:debug
    entrypoint: [""]
  script:
    - sh ./ci/push-navigation-image.sh

build-python-service:
  stage: build
  image: $BASE_URL/$GROUP_NAME/container-templates/python-windows-service-builder:python-service-buzilder
  before_script:
    - cd./native/msi
    - ls -l
    - echo \" \pard\sl240\slmult1\f1\fs18 > docker login $BASE_URL\par\" >> infos.rtf
    - echo \" ">" docker pull $BASE_URL/$GROUP_NAME/demonstrations/navigation:master"\"par\" >> infos.rtf
    - echo \" ">" docker pull $BASE_URL/$GROUP_NAME/demonstrations/phishing:master"\"par\" >> infos.rtf
    - echo \" ">" docker pull $BASE_URL/$GROUP_NAME/demonstrations/password:master"\"par\" >> infos.rtf
    - echo "}" >> infos.rtf
  script: 
    - ls -la
    - pwd
    - cd ./native
    - ls -l
    - bash ./entrypoint-windows.sh $GROUP_NAME
  artifacts:
    paths:
      - /builds/$GROUP_NAME/demonstrations/native/native/dist/windows/*

push-password-image:
  stage: build
  image:
    name: gcr.io/kaniko-project/executor:debug
    entrypoint: [""]
  script:
    - sh ./ci/push-password-image.sh
